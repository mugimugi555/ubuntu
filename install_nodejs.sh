#!/usr/bin/bash

# =============================================================
# Node.js & npm & Yarn æœ€æ–°ç‰ˆã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
# =============================================================

echo "âœ… Node.js ã®æœ€æ–°ç‰ˆã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™..."

# å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®æ›´æ–°
sudo apt update -y
sudo apt install -y curl

# æ—¢å­˜ã® nodejs ã‚’å‰Šé™¤
echo "ğŸ—‘ï¸ æ—¢å­˜ã® Node.js ã‚’å‰Šé™¤..."
sudo apt purge -y nodejs npm
sudo apt autoremove -y

# =============================================================
# Node.js ã‚’ n ã‚’ä½¿ã£ã¦æœ€æ–°ç‰ˆã«æ›´æ–°
# =============================================================
echo "ğŸš€ Node.js ã®æœ€æ–°ç‰ˆã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«..."

# `npm` ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sudo apt install -y npm

# `n` ã‚³ãƒãƒ³ãƒ‰ã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sudo npm install -g n

# æœ€æ–°ã®å®‰å®šç‰ˆ Node.js ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sudo n stable

# å¤ã„ `nodejs` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å‰Šé™¤
sudo apt purge -y nodejs
sudo apt autoremove -y

# =============================================================
# Yarn ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
# =============================================================
echo "ğŸ“¦ Yarn ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«..."
sudo npm install -g yarn

# =============================================================
# ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
# =============================================================
echo "âœ… ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³:"
node -v
npm -v
yarn -v

# ã‚·ã‚§ãƒ«ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦å¤‰æ›´ã‚’é©ç”¨
exec $SHELL -l
